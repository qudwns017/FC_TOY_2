<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.example.kdtbe8_toyproject2.itinerary.db.mapper.ItineraryMapper">
    <select id="findAllItinerary" resultType="org.example.kdtbe8_toyproject2.itinerary.db.entity.ItineraryEntity">
        select * from itinerary
    </select>

    <select id="findAllMove" resultType="org.example.kdtbe8_toyproject2.itinerary.db.entity.MoveEntity">
        select * from move
    </select>

    <select id="findAllStay" resultType="org.example.kdtbe8_toyproject2.itinerary.db.entity.StayEntity">
        select * from stay
    </select>

    <insert id="createItinerary" parameterType="org.example.kdtbe8_toyproject2.itinerary.db.entity.ItineraryEntity">
        insert into itinerary (trip_id,name, type, start_datetime, end_datetime, comment)
        values(#{tripId},#{itineraryName},#{type},#{startDateTime},#{endDateTime},#{comment})
        <selectKey resultType="java.lang.Long" keyProperty="itineraryId" order="AFTER">
            select last_insert_id();
        </selectKey>
    </insert>

    <insert id="createMove" parameterType="org.example.kdtbe8_toyproject2.itinerary.db.entity.MoveEntity">
        insert into move (itinerary_id, transportation, departure_place, arrival_place)
        values(#{itineraryId},#{transportation},#{departurePlace},#{arrivalPlace})
    </insert>

    <insert id="createStay" parameterType="org.example.kdtbe8_toyproject2.itinerary.db.entity.StayEntity">
        insert into stay (itinerary_id, place)
        values(#{itineraryId},#{place})
    </insert>

    <delete id="deleteItinerary">
        delete from itinerary where id=#{itineraryId}
    </delete>
    <delete id="deleteMove">
        delete from move where itinerary_id=#{itineraryId}
    </delete>
    <delete id="deleteStay">
        delete from stay where itinerary_id=#{itineraryId}
    </delete>
</mapper>
